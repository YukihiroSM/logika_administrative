{% load static %}

<script src="{% static 'js/plugins/jquery/jquery-3.5.1.min.js' %}"></script>
<script src="{% static 'js/plugins/jquery/jquery-ui.js' %}"></script>
<script src="{% static 'js/plugins/bootstrap/popper.js' %}"></script>
<script src="{% static 'js/plugins/bootstrap/bootstrap.min.js' %}"></script>
<script src="{% static 'js/plugins/moment/moment.min.js' %}"></script>
<script src="{% static 'js/plugins/accordion.js' %}"></script>
<script src="{% static 'js/plugins/apexcharts.min.js' %}"></script>
<script src="{% static 'js/plugins/autoComplete.js' %}"></script>
<script src="{% static 'js/plugins/Chart.min.js' %}"></script>
<script src="{% static 'js/plugins/daterangepicker.js' %}"></script>
<script src="{% static 'js/plugins/drawer.js' %}"></script>
<script src="{% static 'js/plugins/dynamicBadge.js' %}"></script>
<script src="{% static 'js/plugins/dynamicCheckbox.js' %}"></script>
<script src="{% static 'js/plugins/footable.min.js' %}"></script>
<script src="{% static 'js/plugins/fullcalendar@5.2.0.js' %}"></script>
<script src="{% static 'js/plugins/google-chart.js' %}"></script>
<script src="{% static 'js/plugins/jquery-jvectormap-2.0.5.min.js' %}"></script>
<script src="{% static 'js/plugins/jquery-jvectormap-world-mill-en.js' %}"></script>
<script src="{% static 'js/plugins/jquery.countdown.min.js' %}"></script>
<script src="{% static 'js/plugins/jquery.filterizr.min.js' %}"></script>
<script src="{% static 'js/plugins/jquery.magnific-popup.min.js' %}"></script>
<script src="{% static 'js/plugins/jquery.peity.min.js' %}"></script>
<script src="{% static 'js/plugins/jquery.star-rating-svg.min.js' %}"></script>
<script src="{% static 'js/plugins/leaflet.js' %}"></script>
<script src="{% static 'js/plugins/leaflet.markercluster.js' %}"></script>
<script src="{% static 'js/plugins/loader.js' %}"></script>
<script src="{% static 'js/plugins/message.js' %}"></script>
<script src="{% static 'js/plugins/moment.js' %}"></script>
<script src="{% static 'js/plugins/muuri.min.js' %}"></script>
<script src="{% static 'js/plugins/notification.js' %}"></script>
<script src="{% static 'js/plugins/popover.js' %}"></script>
<script src="{% static 'js/plugins/select2.full.min.js' %}"></script>
<script src="{% static 'js/plugins/slick.min.js' %}"></script>
<script src="{% static 'js/plugins/trumbowyg.min.js' %}"></script>
<script src="{% static 'js/plugins/wickedpicker.min.js' %}"></script>

<script src="{% static 'js/custom/apexmain.js' %}"></script>
<script src="{% static 'js/custom/charts.js' %}"></script>
<script src="{% static 'js/custom/drag-drop.js' %}"></script>
<script src="{% static 'js/custom/footable.js' %}"></script>
<script src="{% static 'js/custom/full-calendar.js' %}"></script>
<script src="{% static 'js/custom/googlemap-init.js' %}"></script>
<script src="{% static 'js/custom/icon-loader.js' %}"></script>
<script src="{% static 'js/custom/jvectormap-init.js' %}"></script>
<script src="{% static 'js/custom/leaflet-init.js' %}"></script>
<script src="{% static 'js/custom/main.js' %}"></script>
<script src="{% static 'js/custom/change-color-of-progress-percentage.js' %}"></script>

<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
<script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>

<!-- DataTablesScript for list_locations.html -->
<script>
    new DataTable('#locations_table', {
        order: [],
        language: {
            "decimal":        "",
            "emptyTable":     "У таблиці немає даних",
            "info":           "Показано з _START_ по _END_ із _TOTAL_ рядків",
            "infoEmpty":      "Показано з 0 по 0 із 0 рядків",
            "infoFiltered":   "(відфільтровано із _MAX_ рядків)",
            "infoPostFix":    "",
            "thousands":      ",",
            "lengthMenu":     "Показувати _MENU_ рядків",
            "loadingRecords": "Завантаження...",
            "processing":     "",
            "search":         "Пошук:",
            "zeroRecords":    "Збігів не знайдено",
            "paginate": {
                "first":      "Перша",
                "last":       "Остання",
                "next":       "Наступна",
                "previous":   "Попередня"
            },
            "aria": {
                "sortAscending":  ": активуйте, щоб відсортувати колонки за зростанням",
                "sortDescending": ": активуйте, щоб відсортувати колонки за спаданням"
            }
        }

    });
</script>

<script>
    var dataTable = new DataTable('#consolidation_table', {
        order: [],
        paging: true,
        ajax: {
            url: "{% url 'logika_statistics:consolidation-report' %}",
            type: "GET",
            dataSrc: "consolidation_reports"  // Data source path in the AJAX response
        },
        columns: [
            { data: 'fields.location' },
            { data: 'fields.group_id' },
            { data: 'fields.student_id' },
            { data: 'fields.group_title' },
            { data: 'fields.lms_total' },
            { data: 'fields.payment_total' },
            { data: 'fields.difference' },
            { data: 'fields.comment' },
            { data: 'fields.type' },
            // Add more columns if needed
            {
                data: null,
                render: function (data, type, row) {
                    var resolveUrl = "{% url 'logika_statistics:resolve-consolidation-report' 999 %}".replace('999', row.pk);
                    return '<a href="' + resolveUrl + '" class="edit"><button class="btn btn-primary"><i class="uil uil-trash-alt"></i> Виправлено</button></a>';
                }
            }
        ],
        language: {
            "decimal":        "",
            "emptyTable":     "У таблиці немає даних",
            "info":           "Показано з _START_ по _END_ із _TOTAL_ рядків",
            "infoEmpty":      "Показано з 0 по 0 із 0 рядків",
            "infoFiltered":   "(відфільтровано із _MAX_ рядків)",
            "infoPostFix":    "",
            "thousands":      ",",
            "lengthMenu":     "Показувати _MENU_ рядків",
            "loadingRecords": "Завантаження...",
            "processing":     "",
            "search":         "Пошук:",
            "zeroRecords":    "Збігів не знайдено",
            "paginate": {
                "first":      "Перша",
                "last":       "Остання",
                "next":       "Наступна",
                "previous":   "Попередня"
            },
            "aria": {
                "sortAscending":  ": активуйте, щоб відсортувати колонки за зростанням",
                "sortDescending": ": активуйте, щоб відсортувати колонки за спаданням"
            }
        }

    });
    document.addEventListener("DOMContentLoaded", function () {
        var urlParams = new URLSearchParams(window.location.search);
        var saveSearch = urlParams.get('saveSearch');

        if (saveSearch === 'true') {
            var savedSearchValue = localStorage.getItem('dataTableSearch');
            if (savedSearchValue) {
                dataTable.search(savedSearchValue).draw();
            }

            dataTable.on('search.dt', function () {
                var currentSearchValue = dataTable.search();
                localStorage.setItem('dataTableSearch', currentSearchValue);
            });
        }
    });
</script>
